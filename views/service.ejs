<!DOCTYPE html>
<html lang="en">
<head>
  <title><%= pageTitle %> - ServiceUs</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" type="text/css" href="/styles/common.css">
  <link rel="stylesheet" type="text/css" href="/styles/header-footer.css">
  <link rel="stylesheet" type="text/css" href="/styles/service.css">
  <script type="application/javascript" src="/script/header-footer.js"></script>
</head>
<body>
  <!-- Include the header -->
  <%- include('./header') %>
<main>  
  <div class="box">Service in Las Vegas</div>
  <div class="box1"></div>
  <!-- The service area --> 
  <div class="all">
    <div class="container">
      <% if (services && services.length > 0) { %>
        <% services.forEach((service) => { %>
          <div class="serviceBox">
            <div class="serviceText">
              <text> Name: <%= service.serviceName %></text>
              <text1>Email: <%= service.email %></text1>
              <text2>Description: <%= service.description %></text2> 
              <text3>Date: <%= service.date %></text3>
              <text4>Time: <%= service.time %>-<%= service.time2 %></text4> 
              <text6>Total hours: <%= service.hours %></text6> 
              <text7>Address: <%= service.address %></text7> 
              <% if (service && service.id && user && user.id) { %>
                <button class="sign-up-button" data-service-id="<%= service.id %>" data-user-id="<%= user.id %>">Sign Up</button>
              <% } else { %>
                <!-- Handle the case where service.id or user.id is not available -->
                <p>Service or user information not available.</p>
              <% } %>
            </div>
          </div>
        <% }) %>
      <% } else { %>
        <!-- Handle the case where services are not available -->
        <p>No services available.</p>
      <% } %>
    </div>
  </div>
  <div class="map">map, when clicked it slides to become the entire page and makes the services 10%</div>
</main>

<!-- The form for inputting data -->
<div class="submit">
  <li class="submitButton"><a href="/submit-service">Submit services</a></li>
</div>

<!-- Include the footer -->
<%- include('./footer') %>

<script type="application/javascript">
  const serviceId = button.getAttribute('data-service-id');
  const userId = button.getAttribute('data-user-id');
  
  function signUp(serviceId, userId) {
    const data = {
      serviceId: serviceId,
      userId: userId,
    };

    fetch('/create-registration', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(data),
    })
      .then(response => {
        if (response.ok) {
          console.log('Registration successful');
        } else {
          console.error('Registration failed');
        }
      })
      .catch(error => {
        console.error('Error:', error);
      });
  }

  document.addEventListener('DOMContentLoaded', function () {
    const signUpButtons = document.querySelectorAll('.sign-up-button');
    signUpButtons.forEach(button => {
      
      button.addEventListener('click', function () {
        const serviceId = button.getAttribute('data-service-id');
        const userId = button.getAttribute('data-user-id');
        console.log(serviceId, userId);
        signUp(serviceId, userId);
      });
    });
  });
</script>

</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
  <title><%= pageTitle %> - ServiceUs</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" type="text/css" href="/styles/common.css">
  <link rel="stylesheet" type="text/css" href="/styles/header-footer.css">
  <link rel="stylesheet" type="text/css" href="/styles/service.css">
  <script type="application/javascript" src="/script/header-footer.js"></script>
</head>
<body>
  <!-- Include the header -->
  <%- include('./header') %>
<main>  
  <div class="box">Service in Las Vegas</div>
  <div class="box1"></div>
  <!-- The service area --> 
  <div class="all">
    <div class="container">
      <% services.forEach((service) => { %>
        <div class="serviceBox">
          <div class="serviceText">
            <text> Name: <%= service.serviceName %></text>
            <text1>Email: <%= service.email %></text1>
            <text2>Description: <%= service.description %></text2> 
            <text3>Date: <%= service.date %></text3>
            <text4>Time: <%= service.time %>-<%= service.time2 %></text4> 
            <text6>Total hours: <%= service.hours %></text6> 
            <text7>Address: <%= service.address %></text7> 
            <button class="sign-up-button" data-service-id="<%= service.id %>">Sign Up</button>
          </div>
        </div>
        <% }) %>
      </div>
      <div class="map">map, when clicked it slides to become the entire page and makes the services 10%</div>
    </div>
  <div id="confirmation-dialog" class="hidden">
    <p>Are you sure you want to sign up for this service?</p>
    <button id="confirm-button">Confirm</button>
    <button id="cancel-button">Cancel</button>
  </div>
</main>

<!-- The form for inputting data -->
<div class="submit">
  <li class="submitButton"><a href="/submit-service">Submit services</a></li>
</div>

<!-- Include the footer -->
<%- include('./footer') %>

<!-- ... Your existing HTML code ... -->

<script>
  // Function to show the confirmation dialog
  function showConfirmationDialog(serviceId) {
    const confirmationDialog = document.getElementById('confirmation-dialog');
    const overlay = document.getElementById('overlay');
    confirmationDialog.style.display = 'block';
    overlay.style.display = 'block';

    // Set a data attribute to store the service ID
    confirmationDialog.setAttribute('data-service-id', serviceId);
  }

  // Function to hide the confirmation dialog
  function hideConfirmationDialog() {
    const confirmationDialog = document.getElementById('confirmation-dialog');
    const overlay = document.getElementById('overlay');
    confirmationDialog.style.display = 'none';
    overlay.style.display = 'none';
  }

  // Function to check if userId is valid and redirect to sign-in if not
  function checkUserIdAndProceed(serviceId) {
    const userId = getUserId(); // Replace with your method to fetch the user's ID

    if (userId) {
      // User is logged in, show the confirmation dialog
      showConfirmationDialog(serviceId);
    } else {
      // User is not logged in, redirect to the sign-in page
      window.location.href = '/sign-in';
    }
  }

  // Attach click event handlers to the "Sign Up" buttons
  const signUpButtons = document.querySelectorAll('.sign-up-button');
  signUpButtons.forEach((button) => {
    button.addEventListener('click', (event) => {
      const serviceId = event.currentTarget.getAttribute('data-service-id');
      checkUserIdAndProceed(serviceId);
    });
  });

  // Attach click event handlers to the "Confirm" and "Cancel" buttons
  const confirmButton = document.getElementById('confirm-button');
  const cancelButton = document.getElementById('cancel-button');
  confirmButton.addEventListener('click', () => {
    const serviceId = document.getElementById('confirmation-dialog').getAttribute('data-service-id');
    // Perform your sign-up logic here
    // You can use the serviceId to identify which service was selected
    // After sign-up, you can hide the dialog by calling hideConfirmationDialog()
    hideConfirmationDialog();
  });
  cancelButton.addEventListener('click', hideConfirmationDialog);

  // Replace this function with your method to fetch the user's ID
  function getUserId() {
    // Implement your logic to retrieve the user's ID here
    // For example, you might use cookies, session storage, or an API call
    // Return the user's ID if they are logged in, or null/undefined if not
    return null; // Change this to the actual user ID or null/undefined
  }
</script>



</body>
</html>